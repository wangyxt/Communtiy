<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>基于 layui 的极简社区页面模版</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="fly,layui,前端社区">
    <meta name="description" content="Fly社区是模块化前端UI框架Layui的官网社区，致力于为web开发提供强动力">

    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <link rel="stylesheet" href="../../res/layui/css/layui.css">
    <link rel="stylesheet" href="../../res/css/global.css">
</head>
<body>
<!--
<ul>
    <li class="layui-nav-item" th:unless="${session.user==null}">
        <a class="fly-nav-avatar" href="javascript:;">
            <cite class="layui-hide-xs" th:text="${session.user.getName()}">用户名</cite>
            <i class="iconfont icon-renzheng layui-hide-xs" title="认证信息：layui 作者"></i>
            <i class="layui-badge fly-badge-vip layui-hide-xs">VIP3</i>
            <img src="https://tva1.sinaimg.cn/crop.0.0.118.118.180/5db11ff4gw1e77d3nqrv8j203b03cweg.jpg">
        </a>
        <dl class="layui-nav-child">
            <dd><a href="user/set.html"><i class="layui-icon">&#xe620;</i>基本设置</a></dd>
            <dd><a href="user/message.html"><i class="iconfont icon-tongzhi" style="top: 4px;"></i>我的消息</a></dd>
            <dd><a href="user/home.html"><i class="layui-icon" style="margin-left: 2px; font-size: 22px;">&#xe68e;</i>我的主页</a></dd>
            <hr style="margin: 5px 0;">
            <dd><a href="/user/logout/" style="text-align: center;">退出</a> </dd>
        </dl>
    </li>
</ul>-->
<form action="/upload">
    <div><img src="" alt=""></div>
    <input name="file" id="file" type="file" multiple="">
    <input type="submit" id="" value="提交">提交
</form>

<script>
    var img1 = document.querySelector('img');
    var div = document.querySelector('div');
    var input = document.querySelector('input');
    input.onchange = function () {
        if (input.files && input.files[0]) {
            if(input.files[0].type == "image/jpeg" || input.files[0].type == "image/gif" || input.files[0].type == "image/png"){
                var byteSize = input.files[0].size / 1024;
                if(byteSize <= 250){
                    var reader = new FileReader();
                    reader.readAsDataURL(input.files[0]);
                    reader.onload = function(ev){
                        var txt = ev.target.result;
                        var img = new Image();
                        img.src = txt;
                        img.onload = function(){
                            if(img.width <= 500 && img.height <= 500){
                                console.log("图片没有错");
                                img1.src = txt;
                                input.multiple=true
                            }else{
                                console.log("尺寸不对 " + img.width + "*" + img.height);
                            }
                        }
                    }
                }else{
                    console.log("文件大小超出 " + byteSize);
                }
            }else{
                console.log("文件类型不对 " + input.files[0].type);
            }
        }else{
            console.log("没有上传，使用默认");
        }
    }
</script>

</body>
</html>